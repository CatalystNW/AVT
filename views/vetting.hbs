<h1>Vetting Home</h1>
<h3>All Applications by Status</h3>

<!-- Section that holds NEW documents -->
<div class="row">
    <div class="col-xs-12">
        <div role="tablist" aria-multiselectable="true">
            <div class="card">
                <div class="card-header" role="tab" id="headingOne">

                    <h5 class="mb-0">
                        <a data-toggle="collapse" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                            New Applications
                        </a>
                    </h5>

                </div>
                <div id="collapseOne" class="collapse in" role="tabpanel" aria-labelledby="headingOne">
                    <div class="card-block">
                        <table class="table table-sm table-bordered table-hover orderTable0">
                            <thead>
                            <tr>
                                <th onclick="orderTable('orderTable0', 0)" class="col-md-2">Name</th>
                                <th onclick="orderTable('orderTable0', 1)" class="col-md-2">Last Edit</th>
                                <th onclick="orderTable('orderTable0', 2)" class="col-md-2">Status</th>
								<th onclick="orderTable('orderTable0', 3)" class="col-md-2">Application Date</th>
								<th onclick="orderTable('orderTable0', 4)" class="col-md-2">Application Number</th>
                            </tr>
                            </thead>
                            <tbody>
                            {{#each new}}
                                <tr class="clickable-row" data-href="/view/{{_id}}">
                                    <td class="col-md-2"><a href="/view/{{_id}}">{{#if application.name.preferred}}{{application.name.preferred}} {{application.name.last}}{{else}}{{application.name.first}} {{application.name.last}}{{/if}}</a></td>
                                    <td class="col-md-2" fullDate="{{updated_full_date}}">{{updated}}</td>
                                    <td class="col-md-2"><span class="text-danger">{{applicationStatus}}</span></td>
									<td class="col-md-2" fullDate="{{this.created_full_date}}">{{this.created_date}}</td>
									<td class="col-md-2">{{app_name}}</td>
                                </tr>
                            {{/each}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section that holds processing documents -->
        <!-- This is a grab bag for any application that is not NEW or DECLINED -->
        <div role="tablist" aria-multiselectable="true">
            <div class="card">
                <div class="card-header" role="tab" id="headingTwo">
                    <h5 class="mb-0">
                        <a data-toggle="collapse" href="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
                            Pending Applications
                        </a>
                    </h5>
                </div>
                <div id="collapseTwo" class="collapse in" role="tabpanel" aria-labelledby="headingTwo">
                    <div class="card-block">
                        <table class="table table-sm table-bordered table-hover orderTable1">
                            <thead>
                            <tr>
                                <th onclick="orderTable('orderTable1', 0)" class="col-md-2">Name</th>
                                <th onclick="orderTable('orderTable1', 1)" class="col-md-2">Last Edit</th>
                                <th onclick="orderTable('orderTable1', 2)" class="col-md-2">Status</th>
								<th onclick="orderTable('orderTable1', 3)" class="col-md-2">Application Date</th>
								<th onclick="orderTable('orderTable1', 4)" class="col-md-2">Application Number</th>
                            </tr>
                            </thead>
                            <tbody>
                            {{#each processing}}
                                <tr class="clickable-row" data-href="/view/{{_id}}">
                                    <td class="col-md-2"><a href="/view/{{_id}}">{{#if application.name.preferred}}{{application.name.preferred}} {{application.name.last}}{{else}}{{application.name.first}} {{application.name.last}}{{/if}}</a></td>
                                    <td class="col-md-2" fullDate="{{updated_full_date}}">{{updated}}</td>
                                    <td class="col-md-2"><span class="text-danger">{{applicationStatus}}</span></td>
									<td class="col-md-2" fullDate="{{this.created_full_date}}">{{this.created_date}}</td>
									<td class="col-md-2">{{app_name}}</td>
                                </tr>
                            {{/each}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div role="tablist" aria-multiselectable="true">
            <div class="card">
                <div class="card-header" role="tab" id="headingTransferred">

                    <h5 class="mb-0">
                        <a data-toggle="collapse" href="#collapseTransferred" aria-expanded="true" aria-controls="collapseTransferred">
                            Transferred
                        </a>
                    </h5>

                </div>
                <div id="collapseTransferred" class="collapse in" role="tabpanel" aria-labelledby="headingTransferred">
                    <div class="card-block">
                        <table class="table table-sm table-bordered table-hover orderTableTransferred">
                            <thead>
                            <tr>
                                <th onclick="orderTable('orderTableTransferred', 0)" class="col-md-2">Name</th>
                                <th onclick="orderTable('orderTableTransferred', 1)" class="col-md-2">Last Edit</th>
                                <th onclick="orderTable('orderTableTransferred', 2)" class="col-md-2">Status</th>
								<th onclick="orderTable('orderTableTransferred', 3)" class="col-md-2">Application Date</th>
								<th onclick="orderTable('orderTableTransferred', 4)" class="col-md-2">Application Number</th>
                            </tr>
                            </thead>
                            <tbody>
                            {{#each transferred}}
                                <tr class="clickable-row" data-href="/view/{{_id}}">
                                    <td class="col-md-2"><a href="/view/{{_id}}">{{#if application.name.preferred}}{{application.name.preferred}} {{application.name.last}}{{else}}{{application.name.first}} {{application.name.last}}{{/if}}</a></td>
                                    <td class="col-md-2" fullDate="{{updated_full_date}}">{{updated}}</td>
                                    <td class="col-md-2"><span class="text-danger">{{applicationStatus}}</span></td>
									<td class="col-md-2" fullDate="{{this.created_full_date}}">{{this.created_date}}</td>
									<td class="col-md-2">{{app_name}}</td>
                                </tr>
                            {{/each}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section that holds declined documents -->
        <div role="tablist" aria-multiselectable="true">
            <div class="card">
                <div class="card-header" role="tab" id="headingThree">
                    <h5 class="mb-0">
                        <a data-toggle="collapse" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
                            Declined/Withdrawn Applications
                        </a>
                    </h5>
					<div id="year_selectDeclined">
					<form class="display_year">
						<select name="year" id="displayYearDeclined">
							{{#each year}}
							<option value={{yearValue}}>{{yearValue}}</option>
							{{/each}}
						</select>
					</form>
					</div>
                </div>
                <div id="collapseThree" class="collapse in" role="tabpanel" aria-labelledby="headingThree">
                    <div class="card-block">
                        <table class="table table-sm table-bordered table-hover orderTable2" id="unapproved_table">
                            <thead>
                            <tr>
                                <th onclick="orderTable('orderTable2', 0)" class="col-md-2">Name</th>
                                <th onclick="orderTable('orderTable2', 1)" class="col-md-2">Last Edit</th>
                                <th onclick="orderTable('orderTable2', 2)" class="col-md-2">Status</th>
								<th onclick="orderTable('orderTable2', 3)" class="col-md-2">Application Date</th>
								<th onclick="orderTable('orderTable2', 4)" class="col-md-2">Application Number</th>
                            </tr>
                            </thead>
                            <tbody>
                            {{#each unapproved}}
                                <tr class="clickable-row" data-href="/view/{{_id}}">
                                    <td class="col-md-2"><a href="/view/{{_id}}">{{#if application.name.preferred}}{{application.name.preferred}} {{application.name.last}}{{else}}{{application.name.first}} {{application.name.last}}{{/if}}</a></td>
                                    <td class="col-md-2" fullDate="{{updated_full_date}}">{{updated}}</td>
                                    <td class="col-md-2"><span class="text-danger">{{applicationStatus}}</span></td>
									<td class="col-md-2" fullDate="{{this.created_full_date}}">{{this.created_date}}</td>
									<td class="col-md-2">{{app_name}}</td>
                                </tr>
                            {{/each}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
		
		<!-- Section that holds approved documents -->
        <div role="tablist" aria-multiselectable="true">
            <div class="card">
                <div class="card-header" role="tab" id="headingFour">
                    <h5 class="mb-0">
                        <a data-toggle="collapse" href="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
                            Approved Applications
                        </a>
                    </h5>
					<div id="year_select">
					<form class="display_year">
						<select name="year" id="displayYear">
							{{#each year}}
							<option value={{yearValue}}>{{yearValue}}</option>
							{{/each}}
						</select>
					</form>
					</div>
						
                </div>
                <div id="collapseFour" class="collapse in" role="tabpanel" aria-labelledby="headingFour">
                    <div class="card-block">
                        <table class="table table-sm table-bordered table-hover orderTable3" id="project_table">
                            <thead>
                            <tr>
                                <th onclick="orderTable('orderTable3', 0)" class="col-md-2">Name</th>
                                <th onclick="orderTable('orderTable3', 1)" class="col-md-2">Last Edit</th>
                                <th onclick="orderTable('orderTable3', 2)" class="col-md-2">Status</th>
								<th onclick="orderTable('orderTable3', 3)" class="col-md-2">Application Date</th>
								<th onclick="orderTable('orderTable3', 4)" class="col-md-2">Application Number</th>
                            </tr>
                            </thead>
                            <tbody>
                            {{#each project}}
                                <tr class="clickable-row" data-href="/view/{{_id}}">
                                    <td class="col-md-2"><a href="/view/{{_id}}">{{#if application.name.preferred}}{{application.name.preferred}} {{application.name.last}}{{else}}{{application.name.first}} {{application.name.last}}{{/if}}</a></td>
                                    <td class="col-md-2" fullDate="{{updated_full_date}}">{{updated}}</td>
                                    <td class="col-md-2"><span class="text-danger">{{applicationStatus}}</span></td>
									<td class="col-md-2" fullDate="{{this.created_full_date}}">{{this.created_date}}</td>
									<td class="col-md-2">{{app_name}}</td>
                                </tr>
                            {{/each}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section that holds waitlisted documents -->
        <div role="tablist" aria-multiselectable="true">
            <div class="card">
                <div class="card-header" role="tab" id="headingFive">

                    <h5 class="mb-0">
                        <a data-toggle="collapse" href="#collapseFive" aria-expanded="true" aria-controls="collapseFive">
                            Waitlist
                        </a>
                    </h5>

                </div>
                <div id="collapseFive" class="collapse in" role="tabpanel" aria-labelledby="headingFive">
                    <div class="card-block">
                        <table class="table table-sm table-bordered table-hover orderTable4">
                            <thead>
                            <tr>
                                <th onclick="orderTable('orderTable4', 0)" class="col-md-2">Name</th>
                                <th onclick="orderTable('orderTable4', 1)" class="col-md-2">Last Edit</th>
                                <th onclick="orderTable('orderTable4', 2)" class="col-md-2">Status</th>
								<th onclick="orderTable('orderTable4', 3)" class="col-md-2">Application Date</th>
								<th onclick="orderTable('orderTable4', 4)" class="col-md-2">Application Number</th>
                            </tr>
                            </thead>
                            <tbody>
                            {{#each waitlist}}
                                <tr class="clickable-row" data-href="/view/{{_id}}">
                                    <td class="col-md-2"><a href="/view/{{_id}}">{{#if application.name.preferred}}{{application.name.preferred}} {{application.name.last}}{{else}}{{application.name.first}} {{application.name.last}}{{/if}}</a></td>
                                    <td class="col-md-2" fullDate="{{updated_full_date}}">{{updated}}</td>
                                    <td class="col-md-2"><span class="text-danger">{{applicationStatus}}</span></td>
									<td class="col-md-2" fullDate="{{this.created_full_date}}">{{this.created_date}}</td>
									<td class="col-md-2">{{app_name}}</td>
                                </tr>
                            {{/each}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div role="tablist" aria-multiselectable="true">
            <div class="card">
                <div class="card-header" role="tab" id="headingNoStatus">

                    <h5 class="mb-0">
                        <a data-toggle="collapse" href="#collapseNoStatus" aria-expanded="true" aria-controls="collapseNoStatus">
                            No Status - Need to Set Status
                        </a>

                        <button class="btn btn-primary" id="convertStatusBtn">
                            Convert Old Status to New
                        </button>
                    </h5>

                </div>
                <div id="collapseNoStatus" class="collapse in" role="tabpanel" aria-labelledby="headingNoStatus">
                    <div class="card-block">
                        <table class="table table-sm table-bordered table-hover orderTableNoStatus">
                            <thead>
                            <tr>
                                <th onclick="orderTable('orderTableNoStatus', 0)" class="col-md-2">Name</th>
                                <th onclick="orderTable('orderTableNoStatus', 1)" class="col-md-2">Last Edit</th>
                                <th onclick="orderTable('orderTableNoStatus', 2)" class="col-md-2">Status</th>
                                <th onclick="orderTable('orderTableNoStatus', 2)" class="col-md-2">Old Status</th>
								<th onclick="orderTable('orderTableNoStatus', 3)" class="col-md-2">Application Date</th>
								<th onclick="orderTable('orderTableNoStatus', 4)" class="col-md-2">Application Number</th>
                            </tr>
                            </thead>
                            <tbody>
                            {{#each noStatus}}
                                <tr>
                                    <td class="col-md-2"><a href="/view/{{_id}}">{{#if application.name.preferred}}{{application.name.preferred}} {{application.name.last}}{{else}}{{application.name.first}} {{application.name.last}}{{/if}}</a></td>
                                    <td class="col-md-2" fullDate="{{updated_full_date}}">{{updated}}</td>
                                    <td class="col-md-2"><span class="text-danger">{{this.applicationStatus}}</span></td>
                                    <td class="col-md-2"><span class="text-danger">{{this.status}}</span></td>
									<td class="col-md-2" fullDate="{{this.created_full_date}}">{{this.created_date}}</td>
									<td class="col-md-2">{{app_name}}</td>
                                </tr>
                            {{/each}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
<script src="/javascript/searchYear.js" type="text/javascript"></script>
<script src="/javascript/orderTable.js" type="text/javascript"></script>
<!-- Make entire table rows clickable! -->
<script>
    jQuery(document).ready(function($) {
        $(".clickable-row").click(function() {
            window.location = $(this).data("href");
        });
    });

    $("#convertStatusBtn").on("click", function(event) {
        const msg = "Converted. If there are any unconverted documents, try to manuall convert it in the vetting page or contact an administrator.";
        $.ajax({
            type: "POST",
            url: "/app_project/document/convert",
            success: function(data, textStatus, xhr) {
                window.alert(msg);
                location.reload();
            },
            error: function(data) {
                window.alert("error");
            }
        });
        
    });
</script>
